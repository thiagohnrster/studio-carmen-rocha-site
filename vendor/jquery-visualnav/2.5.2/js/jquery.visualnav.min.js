/*!
 * Visual Navigation (visualNav) v2.5.2
 * https://github.com/Mottie/visualNav/wiki
 * by Rob Garrison (Mottie)
 * MIT licensed.
 */
!function(t){"use strict";t.visualNav=function(e,n){var i,a=this;a.$el=t(e),a.$el.data("visualNav",a),a.init=function(){var e;a.initialized=!1,a.options=i=t.extend({},t.visualNav.defaultOptions,n),a.winLoc=window.location,a.history="replaceState"in window.history?window.history:null,a.$win=t(window),a.$doc=t(document),a.$body=t("html, body"),a.curHash="",a.$lastItem=[null],a.namespace=".visualNav",t.each(i.easing,function(e,n){t.isFunction(t.easing[n])||(i.easing[e]="swing")}),i.stopOnInteraction&&a.$body.on("scroll mousedown DOMMouseScroll mousewheel keyup ".split(" ").join(a.namespace+" "),function(t){(t.which>0||"mousedown"===t.type||"mousewheel"===t.type)&&a.$body.stop()}),a.$win.on("scroll resize ".split(" ").join(a.namespace+" "),function(){a.throttle()}),a.update(),i.useHash&&a.winLoc.hash&&a.animate(a.winLoc.hash),a.findLocation(),i.scrollOnInit?(e=a.$el.find("."+i.selectedClass+(i.selectedAppliedTo===i.link?"":" "+i.link)),a.animate(e.attr(i.targetAttr)||e.attr("href"),!0)):a.completed(!0)},a.update=function(){a.$content=t("."+i.contentClass),a.leftMargin=parseInt(a.$content.css("margin-left"),10),a.rightMargin=parseInt(a.$content.css("margin-right"),10);var e,n=i.selectedAppliedTo+(i.selectedAppliedTo===i.link?"":" "+i.link),o="."+i.externalLinks;a.$links=t(a.$el.find(n).map(function(n,i){return e=t(i),e.hasClass(o)||e.closest(o).length?null:i})),o="."+i.contentLinks,a.$links.add(t(o+","+o+" a")).off("click.visualNav").on("click.visualNav",function(e,n){var o=t(this);return a.animate(o.attr(i.targetAttr)||o.attr("href"),n),!1}),a.$items=i.selectedAppliedTo===i.link?a.$links:t(a.$links.map(function(){return t(this).closest(i.selectedAppliedTo)[0]})),a.initialized&&a.findLocation()},a.animate=function(e,n){var o,s,l,c,r=t(e);"#"!==e&&r.length&&(o=t(e).eq(0).closest("."+i.contentClass),o.length&&(r=o),r.length&&(a.curHash=r[0].id||"",a.$curContent=r,a.initialized&&"function"==typeof i.beforeAnimation&&i.beforeAnimation(a,r),s=r.offset(),c=Math.min(s.top,a.$doc.height()-a.$win.height())-i.offsetTop,l="function"==typeof i.animationTime?i.animationTime(Math.abs(a.$body.scrollTop()-c))||1200:i.animationTime,a.$body.stop().animate({scrollLeft:Math.min(s.left,a.$doc.width()-a.$win.width())-a.leftMargin,scrollTop:c},{queue:!1,duration:a.initialized?l:0,easing:i.easing[0],specialEasing:{scrollLeft:i.easing[0]||"swing",scrollTop:i.easing[1]||i.easing[0]||"swing"},complete:function(){a.completed(n)}})))},a.throttle=function(){a.flag||(a.flag=!0,a.timer=setTimeout(function(){a.flag=!1,a.findLocation()},100))},a.updateHash=function(){var e,n,o=i.selectedAppliedTo===i.link?a.$curItem.attr(i.targetAttr)||a.$curItem.attr("href"):a.$curItem.find(i.link).attr(i.targetAttr)||a.$curItem.find(i.link).attr("href"),s=(o||"").replace(/^#/,"");o&&""!==s&&s!==a.curHash&&(n=t("#"+s),a.curHash=s,n.length&&(n.attr("id",""),e=t("<div></div>").css({position:"absolute",visibility:"hidden",top:t(document).scrollTop()+"px"}).attr("id",s).appendTo(document.body)),a.setHash("#"+s),n.length&&(e.remove(),n.attr("id",s)))},a.setHash=function(t){a.winLoc.hash!==t&&"#"!==t&&(a.winLoc.replace?null!==a.history?a.history.replaceState({},"",t):a.winLoc.replace(t):a.winLoc.hash=t)},a.completed=function(t){i.useHash&&a.setHash("#"+a.curHash),a.initialized?"function"==typeof i.complete&&i.complete(a,a.$curContent):t&&("function"==typeof i.initialized&&i.initialized(a,a.$curContent),a.initialized=!0),a.flag=!1},a.findLocation=function(){var e,n,o,s,l,c,r,u,d=a.$win.width(),h=a.$win.scrollLeft(),f=a.$win.scrollTop(),p=h+d,m=f+a.$win.height(),g=a.$doc.height();a.$items.removeClass(i.inViewClass),i.fitContent&&a.$content.width(d-a.leftMargin-a.rightMargin),a.$links.each(function(d){s=t(this).attr(i.targetAttr),e="#"!==s&&s.length>1?t(s):"",e.length&&(o=Math.ceil(e.offset().top),n=Math.ceil(e.offset().left),c=e.outerHeight(),l=o+c+i.bottomMargin,r=e.outerWidth(),u=n+r,m>o&&(o+c-i.bottomMargin>f||l>m)&&p>n&&(n+r-i.bottomMargin>h||u>p)&&a.$items.eq(d).addClass(i.inViewClass))}),s=m+i.bottomMargin<g?":first":":last",a.$items.removeClass(i.selectedClass),a.$curItem=a.$items.filter("."+i.inViewClass+s).addClass(i.selectedClass),a.$curItem[0]!==a.$lastItem[0]&&(a.$lastItem=a.$curItem,a.$content.removeClass(i.currentContent),s="."+i.selectedClass+(i.selectedAppliedTo===i.link?"":" "+i.link),e=a.$el.find(s).attr(i.targetAttr),a.$curContent=t(e).closest("."+i.contentClass).addClass(i.currentContent),a.initialized&&"function"==typeof i.changed&&i.changed(a,a.$curContent)),i.useHash&&a.initialized&&a.updateHash()},a.init()},t.visualNav.defaultOptions={link:"a",targetAttr:"href",selectedAppliedTo:"li",contentClass:"content",contentLinks:"visualNav",externalLinks:"external",useHash:!0,inViewClass:"inView",selectedClass:"selected",currentContent:"current",bottomMargin:100,fitContent:!1,offsetTop:0,scrollOnInit:!1,animationTime:1200,stopOnInteraction:!0,easing:["swing","swing"],initialized:null,beforeAnimation:null,complete:null,changed:null},t.fn.visualNav=function(e){return this.each(function(){var n=t(this).data("visualNav");(typeof e).match("object|undefined")?n?n.update():new t.visualNav(this,e):"string"==typeof e&&/^(#|\.)/.test(e)&&n.animate(e)})},t.fn.getvisualNav=function(){return this.data("visualNav")}}(jQuery);
